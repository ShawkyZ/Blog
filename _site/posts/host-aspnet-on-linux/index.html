<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="canonical" href="https://shawkyz.info/posts/host-aspnet-on-linux/" /><link rel="shortcut icon" href="https://shawkyz.info/assets/images/favico.ico" /><title> Host ASP.Net WebApps On Linux</title><meta name="description" content="تكمن المشكلة في إنشاء موقع إلكتروني على الإنترنت في الإستضافة الخاصة بالموقع والتي تأتيك بين أحد الإختيارات التالية:"><link rel="alternate" type="application/rss+xml" title="مدونة شوقي" href="https://shawkyz.info/feed.xml"><link href='https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|Roboto+Condensed:700&subset=latin' rel='stylesheet' type='text/css'><link rel="stylesheet" href="/assets/css/main.css"><meta property="og:url" content="https://shawkyz.info/posts/host-aspnet-on-linux/"><meta property="og:type" content="website"><meta property="og:title" content="Host ASP.Net WebApps On Linux"><meta property="og:description" content="Host ASP.Net WebApps On Linux"><meta property="og:site_name" content="مدونة شوقي"><meta name="twitter:card" content="summary"><meta name="twitter:url" content="https://shawkyz.info/posts/host-aspnet-on-linux/"><meta name="twitter:title" content="Host ASP.Net WebApps On Linux"><meta name="twitter:description" content="Host ASP.Net WebApps On Linux"><meta property="og:image" content="https://shawkyz.info/assets/images/HighlightsvNext.png"><meta name="twitter:image" content="https://shawkyz.info/assets/images/HighlightsvNext.png"><body><div id="shadow"></div><header class="main-header content-wrapper"> <input type="checkbox" id="menu-checkbox" /><nav class="center-wrapper nav-main"> <a class="blog-logo" href="/">مدونة شوقي</a> <a href="/about/">About</a> <a href="/posts/">Archive</a> <a href="/feed.xml">RSS</a> <label for="menu-checkbox" class="toggle-button" data-open="☰" data-close="☰" onclick></label></nav></header><aside class="sidebar" role="note" style="background-image: url(https://shawkyz.info/assets/images/HighlightsvNext.png)"><div class="cover"><div class="cover-text"><div class="heading"> <a href="/posts/#asp.net">asp.net</a> <a href="/posts/#linux">linux</a> <a href="/posts/#opensource">opensource</a></div><p> Host ASP.Net WebApps On Linux</div></div><div id="switcher"></div></aside><main class="content-wrapper"><article class="post"><h1 class="post-title">Host ASP.Net WebApps On Linux</h1><p class="post-meta"> <time datetime="2015-02-17">17-02-2015</time> &nbsp;/&nbsp; <span>shawkyz</span><div class="post-content"><p>تكمن المشكلة في إنشاء موقع إلكتروني على الإنترنت في الإستضافة الخاصة بالموقع والتي تأتيك بين أحد الإختيارات التالية:<p>إستضافة Windows أم إستضافة Linux<p>وهل العميل على إستعداد للدفع مقابل هذه الإستضافة، وهذا كان هو التحدى لإي مبرمج يعمل بـ لغة ASP البرمجية لإنشاء وبرمجة المواقع<p>اليوم وبعد أن أصبح لدينا ASP vNext والذي أصبح منتح مفتوح المصدر بالكامل أصبح لدينا خوادم غير الـ IIS والتي كانت لا تعمل إلّا على خوادم Windows فقط<p>لم نكن نحلم في يوم من الأيام أن نستطيع عمل ASP.NET WebApp ونقوم بإنشاء إستضافة خاصة به على خادم Linux<p>الآن أصبح الأمر ممكنًا ومتاح للجميع، فمنذ فترة أعلنت شركة Microsoft عن ASP.NET vNext وأطلقت عليه الآن “ASP.Net 5” ويمكنك تطوير موقع كامل على خادم OSX و Linux ويمكنك إستضافة الموقع عليه<p>كيف يمكننا فعل ذلك؟ وماذا حدث بالظبط، وما هي الخطوات التي يجب أن اتخذها وما هي الـ vNext ؟<p>مبدأيًا: الـ ASP vNext جميعها مفتوحة المصدر يمكنك التعديل عليها بالكامل كما تحب وقراءة ومشاهدة الكود المصدري، بالإضافة إلى إرسال إقتراحات لـ شركة مايكروسوفت خاصة بتعديلاتك.<p>سوف تجد الـ repo على GitHub من هنا:<p>https://github.com/aspnet/home<p>يذكر أنّ شركة مايكروسوفت في الآونة الأخيرة بدأت تتحد مع فريق Mono فيمكننا في الفترة القادمة توقع ان اي تحديثات خاصة بالـ .NET سوف نجدها في الحال على Mono ولن نضطر للإنتظار بعد الآن بالإضافة إلى إن Mono كـ IDE سوف تتحسن بصورة كبيرة.<p>ما تم في في ASP vNext كان ببساطة نقلة تاريخية لعدة أسباب:<p>١- الـ CSharp Compiler موجود مفتوح المصدر تحت اسم Roslyn.<p>٢- لسنا بحاجة إلى إستخدام الـ IIS Web Server بعد الآن فقد أصبح هناك Kestrel وبسببه يمكننا إستضافة المواقع على خوادم تعمل بـ Linux وكذلك OSX.<p>٣- أصبح الآن كل شئ على Nuget.<p>٤- بعد أن كان لدينا ملفين في المشروع الواحد، ملف خاص بملفات المشروع والثاني خاص بـ Nuget Packages أصبح الاثنين في ملف واحد تحت اسم Project.json<p>في هذه التدوينة سوف نتكلم عن كيف تبرمج Website بـاستخدام ASP vNext و و ما هي الخطوات اللازمة حتى تستضيف الموقع على Linux Machine ،الامثلة القادمة ستكون مرتبطة بتوزيعات لينكس المبنية على Debian.<p>مبدأيًا لكي تبرمجASP.Net Website على الويندوز فمن الممكن ان تستعملVisual Studio 2015 و هذا أسهل حل .. أيضًا ، من الممكن ان تستعمل اي محرر أخر.<p>فلنفترض الآن انك انتهيت من برمجة ال Website بالكامل و تريد استضافته على أحد خوادم Linux فما هي الخطوات اللازمة لذلك؟<p>اذا كنت تعتقد ان الخطوات القادمة من الصعب تنفيذها فلا تقلق ، فقد جهزنا لك Script سوف يقوم بكل هذه المهام من تلقاء نفسه.<p>1- تحتاج الى Mono و يكون أعلى من 3.4.1:<p>اكتب هذه الاوامر في ال Terminal لتحميل و تنصيب Mono 3.8.0<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">build</span><span class="o">-</span><span class="n">essential</span>

<span class="n">wget</span> <span class="n">http</span><span class="o">:</span><span class="c1">//download.mono-project.com/sources/mono/mono-3.8.0.tar.bz2
</span>
<span class="n">tar</span> <span class="o">-</span><span class="n">xvf</span> <span class="n">mono</span><span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">bz2</span>

<span class="n">cd</span> <span class="n">mono</span><span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">0</span><span class="o">/</span>

<span class="p">.</span><span class="o">/</span><span class="n">configure</span> <span class="err">–</span><span class="n">prefix</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span>

<span class="n">make</span>

<span class="n">sudo</span> <span class="n">make</span> <span class="n">install</span></code></pre></figure><p>2- نحتاج الى تحميل SSL Certificates خاصة بميكروسوفت:<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="n">sudo</span> <span class="n">certmgr</span> <span class="o">-</span><span class="n">ssl</span> <span class="o">-</span><span class="n">m</span> <span class="n">https</span><span class="o">:</span><span class="c1">//go.microsoft.com
</span>
<span class="n">sudo</span> <span class="n">certmgr</span> <span class="o">-</span><span class="n">ssl</span> <span class="o">-</span><span class="n">m</span> <span class="n">https</span><span class="o">:</span><span class="c1">//nugetgallery.blob.core.windows.net
</span>
<span class="n">sudo</span> <span class="n">certmgr</span> <span class="o">-</span><span class="n">ssl</span> <span class="o">-</span><span class="n">m</span> <span class="n">https</span><span class="o">:</span><span class="c1">//nuget.org
</span>
<span class="n">sudo</span> <span class="n">certmgr</span> <span class="o">-</span><span class="n">ssl</span> <span class="o">-</span><span class="n">m</span> <span class="n">https</span><span class="o">:</span><span class="c1">//www.myget.org/F/aspnetvnext/
</span>
<span class="n">mozroots</span> <span class="err">–</span><span class="n">import</span> <span class="err">–</span><span class="n">sync</span></code></pre></figure><p>3- نحتاج الى KVM و KRE :<p>*اكتب ال UserName الخاص بـ السيرفر مكان {USER NAME}<p>(KRE (K Runtime Enviroment) , KVM (K Version Manager<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">curl</span>
<span class="n">curl</span> <span class="o">-</span><span class="n">sSL</span> <span class="n">https</span><span class="o">:</span><span class="c1">//raw.githubusercontent.com/aspnet/Home/master/kvminstall.sh | sh &amp;&amp; source ~/.kre/kvm/kvm.sh
</span><span class="n">sudo</span> <span class="o">-</span><span class="n">s</span>
<span class="n">source</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="p">{</span><span class="n">USER</span> <span class="n">NAME</span><span class="p">}</span><span class="o">/</span><span class="p">.</span><span class="n">kre</span><span class="o">/</span><span class="n">kvm</span><span class="o">/</span><span class="n">kvm</span><span class="p">.</span><span class="n">sh</span>
<span class="n">kvm</span> <span class="n">upgrade</span></code></pre></figure><p>4- الآن كل ما نحتاجه لتشغيل Kestrel Web Server اصبح جاهز ، و لكن Kestrel يعتمد على libuv فيجب تنصيبها له:<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">gyp</span>

<span class="n">wget</span> <span class="n">http</span><span class="o">:</span><span class="c1">//dist.libuv.org/dist/v1.0.0-rc2/libuv-v1.0.0-rc2.tar.gz
</span>
<span class="n">tar</span> <span class="o">-</span><span class="n">xvf</span> <span class="n">libuv</span><span class="o">-</span><span class="n">v1</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="n">rc2</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span>

<span class="n">cd</span> <span class="n">libuv</span><span class="o">-</span><span class="n">v1</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="n">rc2</span><span class="o">/</span>

<span class="p">.</span><span class="o">/</span><span class="n">gyp_uv</span><span class="p">.</span><span class="n">py</span> <span class="o">-</span><span class="n">f</span> <span class="n">make</span> <span class="o">-</span><span class="n">Duv_library</span><span class="o">=</span><span class="n">shared_library</span>

<span class="n">make</span> <span class="o">-</span><span class="n">C</span> <span class="n">out</span>

<span class="n">sudo</span> <span class="n">cp</span> <span class="n">out</span><span class="o">/</span><span class="n">Debug</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">target</span><span class="o">/</span><span class="n">libuv</span><span class="p">.</span><span class="n">so</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">libuv</span><span class="p">.</span><span class="n">so</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="n">rc2</span>

<span class="n">sudo</span> <span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="n">libuv</span><span class="p">.</span><span class="n">so</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="n">rc2</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">libuv</span><span class="p">.</span><span class="n">so</span><span class="p">.</span><span class="mi">1</span>

<span class="mi">5</span><span class="o">-</span> <span class="err">تحميل</span> <span class="n">Template</span> <span class="err">جاهز</span> <span class="err">حتى</span> <span class="err">نتأكد</span> <span class="err">ان</span> <span class="err">كل</span> <span class="err">الخطوات</span> <span class="err">السابقة</span> <span class="err">تمت</span> <span class="err">بطريقة</span> <span class="err">صحيحة</span> <span class="o">:</span>

<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">git</span>

<span class="n">git</span> <span class="n">clone</span> <span class="n">http</span><span class="o">:</span><span class="c1">//github.com/aspnet/home
</span>
<span class="n">cd</span> <span class="n">home</span><span class="o">/</span><span class="n">samples</span><span class="o">/</span><span class="n">HelloMvc</span>

<span class="n">kpm</span> <span class="n">restore</span>

<span class="n">kpm</span> <span class="n">build</span></code></pre></figure><p>من الممكن عمل build من خلال الأمر kpm build ، او اذا كنت تريد ان تشغل الserver نكتب k kestrel<p>الان لو كتبت k kestrel و رايت الرسالة Started اذا فمن الممكن تعاين الموقع من خلال الbrowser ادخل على<p>http://localhost:5004<p>ملحوظة: يتم كتابة الاوامر مثل k kestrel او kpm build بداخل ال Directory الخاصة بالموقع.<p>*اذا كنت لا تريد القيام بكل هذه الخطوات من الممكن تحميل ال Script:<p>https://gist.github.com/ShawkyZ/0b3831329a0372e33aef#file-kestrel-configuration<p>*اذا كنت تريد ان تستضيف ال Site على Azure VM مثلًا ، فمن الممكن ان تنشئ واحدة و تستخدم (Putty) مثلًا لكي تتصل بها و تبدأ بعمل كل الخطوات السابقة و عند الانتهاء لا تنسى ان تضبط اعدادات ال EndPoint الخاصة بال VM. <br /> <a class="link-to-post" href="/posts/BotFramework/"> <span class="link-to-post__next">&#10535; &nbsp;Next post</span> <span class="link-to-post__title">Building A Simple Bot Using Microsoft Bot Framework</span> </a> <a class="link-to-post" href="/posts/backup-mssql-database-c/"> <span class="link-to-post__prev">&#10535; &nbsp;Previous post</span> <span class="link-to-post__title">حفظ و استعادة Backup ف MSSQL Database بال #C</span> </a></div></article></main><footer class="blog-footer content-wrapper"><p>&copy; <span class="full-year"></span> مدونة شوقي</footer><script src="/assets/js/scripts.js"></script>
